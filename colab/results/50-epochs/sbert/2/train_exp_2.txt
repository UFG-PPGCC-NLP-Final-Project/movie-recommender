============================================================
EXPERIMENTO 2: SBERT + RNN (features colaborativas)
============================================================

Calculando pos_weight para balancear classes...
  • Amostras analisadas: 3,200
  • Labels positivos: 9,889.0
  • Labels negativos: 21,225,312.0
  • Taxa de positivos: 0.0466%
  • pos_weight calculado: 2146.4

==================================================
Epoch 1/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.04it/s, loss=1.3657]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 1.3794
Eval Loss: 1.3703
nDCG@10: 0.0048
Recall@10: 0.0062
✅ Novo melhor modelo salvo! nDCG@10: 0.0048

==================================================
Epoch 2/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=1.3507]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]
Train Loss: 1.3710
Eval Loss: 1.3470
nDCG@10: 0.0162
Recall@10: 0.0151
✅ Novo melhor modelo salvo! nDCG@10: 0.0162

==================================================
Epoch 3/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.03it/s, loss=1.3587]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]
Train Loss: 1.3338
Eval Loss: 1.3048
nDCG@10: 0.0201
Recall@10: 0.0208
✅ Novo melhor modelo salvo! nDCG@10: 0.0201

==================================================
Epoch 4/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.05it/s, loss=1.1792]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]
Train Loss: 1.2762
Eval Loss: 1.2518
nDCG@10: 0.0219
Recall@10: 0.0233
✅ Novo melhor modelo salvo! nDCG@10: 0.0219

==================================================
Epoch 5/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.00it/s, loss=1.0731]
Evaluating: 100%
 20/20 [00:02<00:00,  7.59it/s]
Train Loss: 1.2034
Eval Loss: 1.1956
nDCG@10: 0.0216
Recall@10: 0.0204
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0219

==================================================
Epoch 6/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=1.1374]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]
Train Loss: 1.1215
Eval Loss: 1.1607
nDCG@10: 0.0231
Recall@10: 0.0240
✅ Novo melhor modelo salvo! nDCG@10: 0.0231

==================================================
Epoch 7/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.9420]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 1.0568
Eval Loss: 1.1502
nDCG@10: 0.0299
Recall@10: 0.0389
✅ Novo melhor modelo salvo! nDCG@10: 0.0299

==================================================
Epoch 8/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.98it/s, loss=1.0817]
Evaluating: 100%
 20/20 [00:02<00:00,  7.43it/s]
Train Loss: 1.0132
Eval Loss: 1.1505
nDCG@10: 0.0333
Recall@10: 0.0451
✅ Novo melhor modelo salvo! nDCG@10: 0.0333

==================================================
Epoch 9/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.9095]
Evaluating: 100%
 20/20 [00:02<00:00,  7.59it/s]
Train Loss: 0.9790
Eval Loss: 1.1499
nDCG@10: 0.0353
Recall@10: 0.0467
✅ Novo melhor modelo salvo! nDCG@10: 0.0353

==================================================
Epoch 10/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.04it/s, loss=1.2007]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]
Train Loss: 0.9537
Eval Loss: 1.1547
nDCG@10: 0.0370
Recall@10: 0.0502
✅ Novo melhor modelo salvo! nDCG@10: 0.0370

==================================================
Epoch 11/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.99it/s, loss=1.0336]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 0.9337
Eval Loss: 1.1637
nDCG@10: 0.0375
Recall@10: 0.0513
✅ Novo melhor modelo salvo! nDCG@10: 0.0375

==================================================
Epoch 12/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=1.0109]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 0.9144
Eval Loss: 1.1733
nDCG@10: 0.0390
Recall@10: 0.0547
✅ Novo melhor modelo salvo! nDCG@10: 0.0390

==================================================
Epoch 13/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.00it/s, loss=0.8974]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]
Train Loss: 0.8978
Eval Loss: 1.1911
nDCG@10: 0.0396
Recall@10: 0.0558
✅ Novo melhor modelo salvo! nDCG@10: 0.0396

==================================================
Epoch 14/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.95it/s, loss=0.8782]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]
Train Loss: 0.8850
Eval Loss: 1.1983
nDCG@10: 0.0402
Recall@10: 0.0556
✅ Novo melhor modelo salvo! nDCG@10: 0.0402

==================================================
Epoch 15/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.03it/s, loss=0.7949]
Evaluating: 100%
 20/20 [00:02<00:00,  7.50it/s]
Train Loss: 0.8720
Eval Loss: 1.2205
nDCG@10: 0.0411
Recall@10: 0.0584
✅ Novo melhor modelo salvo! nDCG@10: 0.0411

==================================================
Epoch 16/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.05it/s, loss=0.8638]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 0.8609
Eval Loss: 1.2100
nDCG@10: 0.0413
Recall@10: 0.0590
✅ Novo melhor modelo salvo! nDCG@10: 0.0413

==================================================
Epoch 17/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.7859]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 0.8509
Eval Loss: 1.2276
nDCG@10: 0.0433
Recall@10: 0.0623
✅ Novo melhor modelo salvo! nDCG@10: 0.0433

==================================================
Epoch 18/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.96it/s, loss=0.8049]
Evaluating: 100%
 20/20 [00:02<00:00,  7.52it/s]
Train Loss: 0.8421
Eval Loss: 1.2120
nDCG@10: 0.0435
Recall@10: 0.0616
✅ Novo melhor modelo salvo! nDCG@10: 0.0435

==================================================
Epoch 19/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.98it/s, loss=0.8860]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]
Train Loss: 0.8338
Eval Loss: 1.2361
nDCG@10: 0.0435
Recall@10: 0.0609
✅ Novo melhor modelo salvo! nDCG@10: 0.0435

==================================================
Epoch 20/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.99it/s, loss=0.7887]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]
Train Loss: 0.8236
Eval Loss: 1.2553
nDCG@10: 0.0438
Recall@10: 0.0615
✅ Novo melhor modelo salvo! nDCG@10: 0.0438

==================================================
Epoch 21/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.95it/s, loss=0.8514]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]
Train Loss: 0.8165
Eval Loss: 1.2686
nDCG@10: 0.0437
Recall@10: 0.0615
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0438

==================================================
Epoch 22/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.7997]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]
Train Loss: 0.8118
Eval Loss: 1.2683
nDCG@10: 0.0446
Recall@10: 0.0633
✅ Novo melhor modelo salvo! nDCG@10: 0.0446

==================================================
Epoch 23/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.8217]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]
Train Loss: 0.8080
Eval Loss: 1.2786
nDCG@10: 0.0445
Recall@10: 0.0625
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0446

==================================================
Epoch 24/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.04it/s, loss=0.8851]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]
Train Loss: 0.8003
Eval Loss: 1.3112
nDCG@10: 0.0459
Recall@10: 0.0640
✅ Novo melhor modelo salvo! nDCG@10: 0.0459

==================================================
Epoch 25/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.98it/s, loss=0.8347]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]
Train Loss: 0.7927
Eval Loss: 1.3171
nDCG@10: 0.0460
Recall@10: 0.0638
✅ Novo melhor modelo salvo! nDCG@10: 0.0460

==================================================
Epoch 26/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.03it/s, loss=0.7489]
Evaluating: 100%
 20/20 [00:02<00:00,  7.51it/s]
Train Loss: 0.7880
Eval Loss: 1.3111
nDCG@10: 0.0476
Recall@10: 0.0664
✅ Novo melhor modelo salvo! nDCG@10: 0.0476

==================================================
Epoch 27/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.97it/s, loss=0.7211]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]
Train Loss: 0.7867
Eval Loss: 1.3135
nDCG@10: 0.0478
Recall@10: 0.0654
✅ Novo melhor modelo salvo! nDCG@10: 0.0478

==================================================
Epoch 28/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.99it/s, loss=0.7809]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]
Train Loss: 0.7835
Eval Loss: 1.3455
nDCG@10: 0.0487
Recall@10: 0.0659
✅ Novo melhor modelo salvo! nDCG@10: 0.0487

==================================================
Epoch 29/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.97it/s, loss=0.7498]
Evaluating: 100%
 20/20 [00:02<00:00,  7.46it/s]
Train Loss: 0.7765
Eval Loss: 1.3553
nDCG@10: 0.0485
Recall@10: 0.0654
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0487

==================================================
Epoch 30/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.7970]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]
Train Loss: 0.7730
Eval Loss: 1.3820
nDCG@10: 0.0502
Recall@10: 0.0675
✅ Novo melhor modelo salvo! nDCG@10: 0.0502

==================================================
Epoch 31/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.99it/s, loss=0.6745]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]
Train Loss: 0.7678
Eval Loss: 1.3859
nDCG@10: 0.0502
Recall@10: 0.0676
✅ Novo melhor modelo salvo! nDCG@10: 0.0502

==================================================
Epoch 32/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.7515]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 0.7650
Eval Loss: 1.3844
nDCG@10: 0.0510
Recall@10: 0.0671
✅ Novo melhor modelo salvo! nDCG@10: 0.0510

==================================================
Epoch 33/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.7797]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]
Train Loss: 0.7633
Eval Loss: 1.3880
nDCG@10: 0.0513
Recall@10: 0.0683
✅ Novo melhor modelo salvo! nDCG@10: 0.0513

==================================================
Epoch 34/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.95it/s, loss=0.7253]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]
Train Loss: 0.7577
Eval Loss: 1.4039
nDCG@10: 0.0511
Recall@10: 0.0676
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0513

==================================================
Epoch 35/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.99it/s, loss=0.6705]
Evaluating: 100%
 20/20 [00:02<00:00,  7.44it/s]
Train Loss: 0.7561
Eval Loss: 1.4369
nDCG@10: 0.0515
Recall@10: 0.0680
✅ Novo melhor modelo salvo! nDCG@10: 0.0515

==================================================
Epoch 36/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.7567]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]
Train Loss: 0.7543
Eval Loss: 1.4203
nDCG@10: 0.0530
Recall@10: 0.0704
✅ Novo melhor modelo salvo! nDCG@10: 0.0530

==================================================
Epoch 37/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.6756]
Evaluating: 100%
 20/20 [00:02<00:00,  7.52it/s]
Train Loss: 0.7508
Eval Loss: 1.4412
nDCG@10: 0.0520
Recall@10: 0.0687
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0530

==================================================
Epoch 38/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.7633]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]
Train Loss: 0.7509
Eval Loss: 1.4247
nDCG@10: 0.0528
Recall@10: 0.0704
⚠️  Sem melhoria por 2 época(s)
   Melhor nDCG@10: 0.0530

==================================================
Epoch 39/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.98it/s, loss=0.8182]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]
Train Loss: 0.7468
Eval Loss: 1.4467
nDCG@10: 0.0527
Recall@10: 0.0697
⚠️  Sem melhoria por 3 época(s)
   Melhor nDCG@10: 0.0530

==================================================
Epoch 40/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.97it/s, loss=0.7289]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]
Train Loss: 0.7457
Eval Loss: 1.4608
nDCG@10: 0.0529
Recall@10: 0.0699
⚠️  Sem melhoria por 4 época(s)
   Melhor nDCG@10: 0.0530

==================================================
Epoch 41/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.99it/s, loss=0.7172]
Evaluating: 100%
 20/20 [00:02<00:00,  7.51it/s]
Train Loss: 0.7433
Eval Loss: 1.4447
nDCG@10: 0.0531
Recall@10: 0.0697
✅ Novo melhor modelo salvo! nDCG@10: 0.0531

==================================================
Epoch 42/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.97it/s, loss=0.7348]
Evaluating: 100%
 20/20 [00:02<00:00,  7.48it/s]
Train Loss: 0.7417
Eval Loss: 1.4686
nDCG@10: 0.0531
Recall@10: 0.0695
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0531

==================================================
Epoch 43/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.00it/s, loss=0.7905]
Evaluating: 100%
 20/20 [00:02<00:00,  7.59it/s]
Train Loss: 0.7391
Eval Loss: 1.4672
nDCG@10: 0.0537
Recall@10: 0.0713
✅ Novo melhor modelo salvo! nDCG@10: 0.0537

==================================================
Epoch 44/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.04it/s, loss=0.8206]
Evaluating: 100%
 20/20 [00:02<00:00,  7.59it/s]
Train Loss: 0.7385
Eval Loss: 1.4732
nDCG@10: 0.0530
Recall@10: 0.0691
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0537

==================================================
Epoch 45/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.03it/s, loss=0.7507]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]
Train Loss: 0.7372
Eval Loss: 1.4874
nDCG@10: 0.0528
Recall@10: 0.0696
⚠️  Sem melhoria por 2 época(s)
   Melhor nDCG@10: 0.0537

==================================================
Epoch 46/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.7310]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]
Train Loss: 0.7376
Eval Loss: 1.4702
nDCG@10: 0.0536
Recall@10: 0.0708
⚠️  Sem melhoria por 3 época(s)
   Melhor nDCG@10: 0.0537

==================================================
Epoch 47/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.6736]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 0.7356
Eval Loss: 1.4714
nDCG@10: 0.0539
Recall@10: 0.0712
✅ Novo melhor modelo salvo! nDCG@10: 0.0539

==================================================
Epoch 48/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.7674]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]
Train Loss: 0.7344
Eval Loss: 1.4894
nDCG@10: 0.0537
Recall@10: 0.0709
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0539

==================================================
Epoch 49/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.04it/s, loss=0.7618]
Evaluating: 100%
 20/20 [00:02<00:00,  7.59it/s]
Train Loss: 0.7343
Eval Loss: 1.4812
nDCG@10: 0.0540
Recall@10: 0.0712
✅ Novo melhor modelo salvo! nDCG@10: 0.0540

==================================================
Epoch 50/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.05it/s, loss=0.8147]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]
Train Loss: 0.7329
Eval Loss: 1.4848
nDCG@10: 0.0538
Recall@10: 0.0712
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0540