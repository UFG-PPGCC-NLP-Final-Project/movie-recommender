============================================================
EXPERIMENTO 3: SBERT + Multi-Task (user tags)
============================================================

Calculando pos_weight para balancear classes...
  â€¢ Amostras analisadas: 3,200
  â€¢ Labels positivos: 9,864.0
  â€¢ Labels negativos: 21,225,336.0
  â€¢ Taxa de positivos: 0.0465%
  â€¢ pos_weight calculado: 2151.8

==================================================
Epoch 1/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.04it/s,â€‡loss=2.2701]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.60it/s]
Train Loss: 2.2630
Eval Loss: 1.3711
nDCG@10: 0.0003
Recall@10: 0.0005
âœ… Novo melhor modelo salvo! nDCG@10: 0.0003

==================================================
Epoch 2/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.04it/s,â€‡loss=2.2722]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.60it/s]
Train Loss: 2.2445
Eval Loss: 1.3284
nDCG@10: 0.0217
Recall@10: 0.0270
âœ… Novo melhor modelo salvo! nDCG@10: 0.0217

==================================================
Epoch 3/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡5.99it/s,â€‡loss=2.1017]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.62it/s]
Train Loss: 2.1638
Eval Loss: 1.2477
nDCG@10: 0.0354
Recall@10: 0.0479
âœ… Novo melhor modelo salvo! nDCG@10: 0.0354

==================================================
Epoch 4/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.04it/s,â€‡loss=1.9900]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.61it/s]
Train Loss: 2.0465
Eval Loss: 1.1729
nDCG@10: 0.0355
Recall@10: 0.0515
âœ… Novo melhor modelo salvo! nDCG@10: 0.0355

==================================================
Epoch 5/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.03it/s,â€‡loss=1.7490]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.46it/s]
Train Loss: 1.8923
Eval Loss: 1.1384
nDCG@10: 0.0365
Recall@10: 0.0524
âœ… Novo melhor modelo salvo! nDCG@10: 0.0365

==================================================
Epoch 6/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.06it/s,â€‡loss=1.7868]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.61it/s]
Train Loss: 1.7525
Eval Loss: 1.1446
nDCG@10: 0.0399
Recall@10: 0.0602
âœ… Novo melhor modelo salvo! nDCG@10: 0.0399

==================================================
Epoch 7/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.02it/s,â€‡loss=1.5788]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.57it/s]
Train Loss: 1.6742
Eval Loss: 1.1616
nDCG@10: 0.0433
Recall@10: 0.0678
âœ… Novo melhor modelo salvo! nDCG@10: 0.0433

==================================================
Epoch 8/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.00it/s,â€‡loss=1.5421]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.58it/s]
Train Loss: 1.6311
Eval Loss: 1.1813
nDCG@10: 0.0430
Recall@10: 0.0670
âš ï¸  Sem melhoria por 1 Ã©poca(s)
   Melhor nDCG@10: 0.0433

==================================================
Epoch 9/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.03it/s,â€‡loss=1.5469]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.60it/s]
Train Loss: 1.6029
Eval Loss: 1.1952
nDCG@10: 0.0456
Recall@10: 0.0679
âœ… Novo melhor modelo salvo! nDCG@10: 0.0456

==================================================
Epoch 10/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.01it/s,â€‡loss=1.7648]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.51it/s]
Train Loss: 1.5814
Eval Loss: 1.2055
nDCG@10: 0.0469
Recall@10: 0.0701
âœ… Novo melhor modelo salvo! nDCG@10: 0.0469

==================================================
Epoch 11/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.07it/s,â€‡loss=1.5205]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.59it/s]
Train Loss: 1.5612
Eval Loss: 1.2169
nDCG@10: 0.0476
Recall@10: 0.0705
âœ… Novo melhor modelo salvo! nDCG@10: 0.0476

==================================================
Epoch 12/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.01it/s,â€‡loss=1.5701]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.53it/s]
Train Loss: 1.5461
Eval Loss: 1.2162
nDCG@10: 0.0485
Recall@10: 0.0717
âœ… Novo melhor modelo salvo! nDCG@10: 0.0485

==================================================
Epoch 13/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.05it/s,â€‡loss=1.4962]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.63it/s]
Train Loss: 1.5301
Eval Loss: 1.2378
nDCG@10: 0.0486
Recall@10: 0.0706
âœ… Novo melhor modelo salvo! nDCG@10: 0.0486

==================================================
Epoch 14/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.08it/s,â€‡loss=1.5929]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.64it/s]
Train Loss: 1.5172
Eval Loss: 1.2292
nDCG@10: 0.0485
Recall@10: 0.0700
âš ï¸  Sem melhoria por 1 Ã©poca(s)
   Melhor nDCG@10: 0.0486

==================================================
Epoch 15/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.03it/s,â€‡loss=1.5751]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.49it/s]
Train Loss: 1.5067
Eval Loss: 1.2455
nDCG@10: 0.0486
Recall@10: 0.0696
âœ… Novo melhor modelo salvo! nDCG@10: 0.0486

==================================================
Epoch 16/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.03it/s,â€‡loss=1.4677]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.56it/s]
Train Loss: 1.4954
Eval Loss: 1.2639
nDCG@10: 0.0486
Recall@10: 0.0701
âš ï¸  Sem melhoria por 1 Ã©poca(s)
   Melhor nDCG@10: 0.0486

==================================================
Epoch 17/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.03it/s,â€‡loss=1.4992]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.58it/s]
Train Loss: 1.4851
Eval Loss: 1.2888
nDCG@10: 0.0492
Recall@10: 0.0709
âœ… Novo melhor modelo salvo! nDCG@10: 0.0492

==================================================
Epoch 18/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.00it/s,â€‡loss=1.4798]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.63it/s]
Train Loss: 1.4768
Eval Loss: 1.2808
nDCG@10: 0.0497
Recall@10: 0.0716
âœ… Novo melhor modelo salvo! nDCG@10: 0.0497

==================================================
Epoch 19/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.05it/s,â€‡loss=1.4683]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.59it/s]
Train Loss: 1.4695
Eval Loss: 1.3110
nDCG@10: 0.0491
Recall@10: 0.0697
âš ï¸  Sem melhoria por 1 Ã©poca(s)
   Melhor nDCG@10: 0.0497

==================================================
Epoch 20/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.04it/s,â€‡loss=1.3586]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.56it/s]
Train Loss: 1.4586
Eval Loss: 1.2887
nDCG@10: 0.0493
Recall@10: 0.0704
âš ï¸  Sem melhoria por 2 Ã©poca(s)
   Melhor nDCG@10: 0.0497

==================================================
Epoch 21/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.04it/s,â€‡loss=1.3365]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.56it/s]
Train Loss: 1.4517
Eval Loss: 1.3321
nDCG@10: 0.0485
Recall@10: 0.0684
âš ï¸  Sem melhoria por 3 Ã©poca(s)
   Melhor nDCG@10: 0.0497

==================================================
Epoch 22/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.06it/s,â€‡loss=1.4316]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.59it/s]
Train Loss: 1.4457
Eval Loss: 1.3473
nDCG@10: 0.0489
Recall@10: 0.0682
âš ï¸  Sem melhoria por 4 Ã©poca(s)
   Melhor nDCG@10: 0.0497

==================================================
Epoch 23/50
==================================================
Training:â€‡100%
â€‡292/292â€‡[00:48<00:00,â€‡â€‡6.04it/s,â€‡loss=1.3769]
Evaluating:â€‡100%
â€‡20/20â€‡[00:02<00:00,â€‡â€‡7.59it/s]
Train Loss: 1.4380
Eval Loss: 1.3741
nDCG@10: 0.0492
Recall@10: 0.0686
âš ï¸  Sem melhoria por 5 Ã©poca(s)
   Melhor nDCG@10: 0.0497

ðŸ›‘ Early stopping ativado! Melhor Ã©poca: 18