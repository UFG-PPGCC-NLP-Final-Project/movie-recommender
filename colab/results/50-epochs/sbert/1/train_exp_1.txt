============================================================
EXPERIMENTO 1: SBERT Baseline (sem RNN, sem multi-task)
============================================================
config.json: 100%
 612/612 [00:00<00:00, 76.4kB/s]
model.safetensors: 100%
 90.9M/90.9M [00:00<00:00, 1.13MB/s]

Calculando pos_weight para balancear classes...
  • Amostras analisadas: 3,200
  • Labels positivos: 9,771.0
  • Labels negativos: 21,225,428.0
  • Taxa de positivos: 0.0460%
  • pos_weight calculado: 2172.3

==================================================
Epoch 1/50
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.13it/s, loss=1.3634]
Evaluating: 100%
 20/20 [00:02<00:00,  7.73it/s]
Train Loss: 1.3896
Eval Loss: 1.3790
nDCG@10: 0.0021
Recall@10: 0.0033
✅ Novo melhor modelo salvo! nDCG@10: 0.0021

==================================================
Epoch 2/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.10it/s, loss=1.3385]
Evaluating: 100%
 20/20 [00:02<00:00,  7.70it/s]
Train Loss: 1.3793
Eval Loss: 1.3556
nDCG@10: 0.0078
Recall@10: 0.0168
✅ Novo melhor modelo salvo! nDCG@10: 0.0078

==================================================
Epoch 3/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.15it/s, loss=1.3338]
Evaluating: 100%
 20/20 [00:02<00:00,  7.68it/s]
Train Loss: 1.3446
Eval Loss: 1.3246
nDCG@10: 0.0213
Recall@10: 0.0310
✅ Novo melhor modelo salvo! nDCG@10: 0.0213

==================================================
Epoch 4/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.14it/s, loss=1.2704]
Evaluating: 100%
 20/20 [00:02<00:00,  7.71it/s]
Train Loss: 1.2972
Eval Loss: 1.2846
nDCG@10: 0.0259
Recall@10: 0.0378
✅ Novo melhor modelo salvo! nDCG@10: 0.0259

==================================================
Epoch 5/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.11it/s, loss=1.2267]
Evaluating: 100%
 20/20 [00:02<00:00,  7.64it/s]
Train Loss: 1.2282
Eval Loss: 1.2421
nDCG@10: 0.0278
Recall@10: 0.0407
✅ Novo melhor modelo salvo! nDCG@10: 0.0278

==================================================
Epoch 6/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.10it/s, loss=0.9994]
Evaluating: 100%
 20/20 [00:02<00:00,  7.69it/s]
Train Loss: 1.1540
Eval Loss: 1.2121
nDCG@10: 0.0306
Recall@10: 0.0481
✅ Novo melhor modelo salvo! nDCG@10: 0.0306

==================================================
Epoch 7/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.12it/s, loss=1.0310]
Evaluating: 100%
 20/20 [00:02<00:00,  7.47it/s]
Train Loss: 1.0876
Eval Loss: 1.1974
nDCG@10: 0.0315
Recall@10: 0.0512
✅ Novo melhor modelo salvo! nDCG@10: 0.0315

==================================================
Epoch 8/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.12it/s, loss=1.1628]
Evaluating: 100%
 20/20 [00:02<00:00,  7.71it/s]
Train Loss: 1.0410
Eval Loss: 1.1929
nDCG@10: 0.0360
Recall@10: 0.0503
✅ Novo melhor modelo salvo! nDCG@10: 0.0360

==================================================
Epoch 9/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.08it/s, loss=1.0577]
Evaluating: 100%
 20/20 [00:02<00:00,  7.69it/s]
Train Loss: 1.0046
Eval Loss: 1.1882
nDCG@10: 0.0395
Recall@10: 0.0551
✅ Novo melhor modelo salvo! nDCG@10: 0.0395

==================================================
Epoch 10/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.10it/s, loss=1.0139]
Evaluating: 100%
 20/20 [00:02<00:00,  7.69it/s]
Train Loss: 0.9731
Eval Loss: 1.2001
nDCG@10: 0.0381
Recall@10: 0.0543
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0395

==================================================
Epoch 11/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.08it/s, loss=0.9817]
Evaluating: 100%
 20/20 [00:02<00:00,  7.64it/s]
Train Loss: 0.9465
Eval Loss: 1.1998
nDCG@10: 0.0406
Recall@10: 0.0564
✅ Novo melhor modelo salvo! nDCG@10: 0.0406

==================================================
Epoch 12/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.07it/s, loss=0.9212]
Evaluating: 100%
 20/20 [00:02<00:00,  7.49it/s]
Train Loss: 0.9279
Eval Loss: 1.2168
nDCG@10: 0.0394
Recall@10: 0.0536
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0406

==================================================
Epoch 13/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.11it/s, loss=0.8927]
Evaluating: 100%
 20/20 [00:02<00:00,  7.65it/s]
Train Loss: 0.9117
Eval Loss: 1.2169
nDCG@10: 0.0414
Recall@10: 0.0571
✅ Novo melhor modelo salvo! nDCG@10: 0.0414

==================================================
Epoch 14/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.09it/s, loss=0.8583]
Evaluating: 100%
 20/20 [00:02<00:00,  7.67it/s]
Train Loss: 0.8954
Eval Loss: 1.2195
nDCG@10: 0.0433
Recall@10: 0.0605
✅ Novo melhor modelo salvo! nDCG@10: 0.0433

==================================================
Epoch 15/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.13it/s, loss=0.9237]
Evaluating: 100%
 20/20 [00:02<00:00,  7.70it/s]
Train Loss: 0.8816
Eval Loss: 1.2164
nDCG@10: 0.0458
Recall@10: 0.0641
✅ Novo melhor modelo salvo! nDCG@10: 0.0458

==================================================
Epoch 16/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.12it/s, loss=0.8427]
Evaluating: 100%
 20/20 [00:02<00:00,  7.68it/s]
Train Loss: 0.8699
Eval Loss: 1.2358
nDCG@10: 0.0440
Recall@10: 0.0636
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0458

==================================================
Epoch 17/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.10it/s, loss=0.7859]
Evaluating: 100%
 20/20 [00:02<00:00,  7.66it/s]
Train Loss: 0.8601
Eval Loss: 1.2354
nDCG@10: 0.0437
Recall@10: 0.0619
⚠️  Sem melhoria por 2 época(s)
   Melhor nDCG@10: 0.0458

==================================================
Epoch 18/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.11it/s, loss=0.8491]
Evaluating: 100%
 20/20 [00:02<00:00,  7.61it/s]
Train Loss: 0.8488
Eval Loss: 1.2670
nDCG@10: 0.0435
Recall@10: 0.0618
⚠️  Sem melhoria por 3 época(s)
   Melhor nDCG@10: 0.0458

==================================================
Epoch 19/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.11it/s, loss=0.8550]
Evaluating: 100%
 20/20 [00:02<00:00,  7.67it/s]
Train Loss: 0.8409
Eval Loss: 1.2721
nDCG@10: 0.0433
Recall@10: 0.0607
⚠️  Sem melhoria por 4 época(s)
   Melhor nDCG@10: 0.0458

==================================================
Epoch 20/50
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.08it/s, loss=0.8940]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 0.8302
Eval Loss: 1.2388
nDCG@10: 0.0450
Recall@10: 0.0627
⚠️  Sem melhoria por 5 época(s)
   Melhor nDCG@10: 0.0458