============================================================
EXPERIMENTO 3: SBERT + Multi-Task (user tags)
============================================================

Calculando pos_weight para balancear classes...
  • Amostras analisadas: 3,200
  • Labels positivos: 9,893.0
  • Labels negativos: 21,225,308.0
  • Taxa de positivos: 0.0466%
  • pos_weight calculado: 2145.5

==================================================
Epoch 1/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.02it/s, loss=2.2785]
Evaluating: 100%
 20/20 [00:02<00:00,  7.64it/s]
Train Loss: 2.2621
Eval Loss: 1.3722
nDCG@10: 0.0015
Recall@10: 0.0022
✅ Novo melhor modelo salvo! nDCG@10: 0.0015

==================================================
Epoch 2/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.06it/s, loss=2.2682]
Evaluating: 100%
 20/20 [00:02<00:00,  7.65it/s]
Train Loss: 2.2519
Eval Loss: 1.3514
nDCG@10: 0.0078
Recall@10: 0.0128
✅ Novo melhor modelo salvo! nDCG@10: 0.0078

==================================================
Epoch 3/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.07it/s, loss=2.1654]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 2.2144
Eval Loss: 1.3132
nDCG@10: 0.0121
Recall@10: 0.0121
✅ Novo melhor modelo salvo! nDCG@10: 0.0121

==================================================
Epoch 4/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.08it/s, loss=1.9941]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]
Train Loss: 2.1545
Eval Loss: 1.2682
nDCG@10: 0.0100
Recall@10: 0.0128
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0121

==================================================
Epoch 5/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.05it/s, loss=1.9285]
Evaluating: 100%
 20/20 [00:02<00:00,  7.64it/s]
Train Loss: 2.0445
Eval Loss: 1.2090
nDCG@10: 0.0136
Recall@10: 0.0234
✅ Novo melhor modelo salvo! nDCG@10: 0.0136

==================================================
Epoch 6/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.05it/s, loss=1.8762]
Evaluating: 100%
 20/20 [00:02<00:00,  7.63it/s]
Train Loss: 1.9120
Eval Loss: 1.1710
nDCG@10: 0.0145
Recall@10: 0.0235
✅ Novo melhor modelo salvo! nDCG@10: 0.0145

==================================================
Epoch 7/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.08it/s, loss=1.7415]
Evaluating: 100%
 20/20 [00:02<00:00,  7.62it/s]
Train Loss: 1.8217
Eval Loss: 1.1567
nDCG@10: 0.0241
Recall@10: 0.0283
✅ Novo melhor modelo salvo! nDCG@10: 0.0241

==================================================
Epoch 8/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.08it/s, loss=1.6878]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 1.7632
Eval Loss: 1.1532
nDCG@10: 0.0258
Recall@10: 0.0300
✅ Novo melhor modelo salvo! nDCG@10: 0.0258

==================================================
Epoch 9/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.05it/s, loss=1.6108]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]
Train Loss: 1.7151
Eval Loss: 1.1579
nDCG@10: 0.0283
Recall@10: 0.0323
✅ Novo melhor modelo salvo! nDCG@10: 0.0283

==================================================
Epoch 10/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.08it/s, loss=1.5892]
Evaluating: 100%
 20/20 [00:02<00:00,  7.66it/s]
Train Loss: 1.6825
Eval Loss: 1.1650
nDCG@10: 0.0305
Recall@10: 0.0365
✅ Novo melhor modelo salvo! nDCG@10: 0.0305

==================================================
Epoch 11/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.06it/s, loss=1.7113]
Evaluating: 100%
 20/20 [00:02<00:00,  7.59it/s]
Train Loss: 1.6556
Eval Loss: 1.1711
nDCG@10: 0.0337
Recall@10: 0.0439
✅ Novo melhor modelo salvo! nDCG@10: 0.0337

==================================================
Epoch 12/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.06it/s, loss=1.6226]
Evaluating: 100%
 20/20 [00:02<00:00,  7.66it/s]
Train Loss: 1.6333
Eval Loss: 1.1737
nDCG@10: 0.0357
Recall@10: 0.0457
✅ Novo melhor modelo salvo! nDCG@10: 0.0357

==================================================
Epoch 13/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.07it/s, loss=1.5780]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]
Train Loss: 1.6143
Eval Loss: 1.1854
nDCG@10: 0.0354
Recall@10: 0.0453
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0357

==================================================
Epoch 14/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.06it/s, loss=1.5847]
Evaluating: 100%
 20/20 [00:02<00:00,  7.64it/s]
Train Loss: 1.5922
Eval Loss: 1.1813
nDCG@10: 0.0365
Recall@10: 0.0465
✅ Novo melhor modelo salvo! nDCG@10: 0.0365

==================================================
Epoch 15/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.07it/s, loss=1.5825]
Evaluating: 100%
 20/20 [00:02<00:00,  7.65it/s]
Train Loss: 1.5760
Eval Loss: 1.1978
nDCG@10: 0.0408
Recall@10: 0.0541
✅ Novo melhor modelo salvo! nDCG@10: 0.0408

==================================================
Epoch 16/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.07it/s, loss=1.5242]
Evaluating: 100%
 20/20 [00:02<00:00,  7.65it/s]
Train Loss: 1.5633
Eval Loss: 1.2046
nDCG@10: 0.0410
Recall@10: 0.0545
✅ Novo melhor modelo salvo! nDCG@10: 0.0410

==================================================
Epoch 17/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.04it/s, loss=1.5928]
Evaluating: 100%
 20/20 [00:02<00:00,  7.66it/s]
Train Loss: 1.5482
Eval Loss: 1.2106
nDCG@10: 0.0417
Recall@10: 0.0556
✅ Novo melhor modelo salvo! nDCG@10: 0.0417

==================================================
Epoch 18/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.08it/s, loss=1.4666]
Evaluating: 100%
 20/20 [00:02<00:00,  7.62it/s]
Train Loss: 1.5375
Eval Loss: 1.2222
nDCG@10: 0.0433
Recall@10: 0.0576
✅ Novo melhor modelo salvo! nDCG@10: 0.0433

==================================================
Epoch 19/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.07it/s, loss=1.6370]
Evaluating: 100%
 20/20 [00:02<00:00,  7.59it/s]
Train Loss: 1.5285
Eval Loss: 1.2408
nDCG@10: 0.0448
Recall@10: 0.0592
✅ Novo melhor modelo salvo! nDCG@10: 0.0448

==================================================
Epoch 20/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.06it/s, loss=1.4793]
Evaluating: 100%
 20/20 [00:02<00:00,  7.67it/s]
Train Loss: 1.5147
Eval Loss: 1.2528
nDCG@10: 0.0481
Recall@10: 0.0637
✅ Novo melhor modelo salvo! nDCG@10: 0.0481

==================================================
Epoch 21/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.07it/s, loss=1.4173]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]
Train Loss: 1.5080
Eval Loss: 1.2469
nDCG@10: 0.0478
Recall@10: 0.0630
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0481

==================================================
Epoch 22/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.06it/s, loss=1.5908]
Evaluating: 100%
 20/20 [00:02<00:00,  7.67it/s]
Train Loss: 1.4998
Eval Loss: 1.2838
nDCG@10: 0.0479
Recall@10: 0.0645
⚠️  Sem melhoria por 2 época(s)
   Melhor nDCG@10: 0.0481

==================================================
Epoch 23/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.08it/s, loss=1.4095]
Evaluating: 100%
 20/20 [00:02<00:00,  7.66it/s]
Train Loss: 1.4908
Eval Loss: 1.2694
nDCG@10: 0.0489
Recall@10: 0.0652
✅ Novo melhor modelo salvo! nDCG@10: 0.0489

==================================================
Epoch 24/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.07it/s, loss=1.4157]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]
Train Loss: 1.4832
Eval Loss: 1.2785
nDCG@10: 0.0495
Recall@10: 0.0660
✅ Novo melhor modelo salvo! nDCG@10: 0.0495

==================================================
Epoch 25/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.04it/s, loss=1.4218]
Evaluating: 100%
 20/20 [00:02<00:00,  7.64it/s]
Train Loss: 1.4760
Eval Loss: 1.2902
nDCG@10: 0.0499
Recall@10: 0.0662
✅ Novo melhor modelo salvo! nDCG@10: 0.0499

==================================================
Epoch 26/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.10it/s, loss=1.6151]
Evaluating: 100%
 20/20 [00:02<00:00,  7.63it/s]
Train Loss: 1.4677
Eval Loss: 1.3009
nDCG@10: 0.0505
Recall@10: 0.0665
✅ Novo melhor modelo salvo! nDCG@10: 0.0505

==================================================
Epoch 27/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.08it/s, loss=1.5759]
Evaluating: 100%
 20/20 [00:02<00:00,  7.61it/s]
Train Loss: 1.4616
Eval Loss: 1.3303
nDCG@10: 0.0505
Recall@10: 0.0669
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0505

==================================================
Epoch 28/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.05it/s, loss=1.4396]
Evaluating: 100%
 20/20 [00:02<00:00,  7.61it/s]
Train Loss: 1.4557
Eval Loss: 1.3223
nDCG@10: 0.0500
Recall@10: 0.0654
⚠️  Sem melhoria por 2 época(s)
   Melhor nDCG@10: 0.0505

==================================================
Epoch 29/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.10it/s, loss=1.4520]
Evaluating: 100%
 20/20 [00:02<00:00,  7.65it/s]
Train Loss: 1.4508
Eval Loss: 1.3217
nDCG@10: 0.0495
Recall@10: 0.0655
⚠️  Sem melhoria por 3 época(s)
   Melhor nDCG@10: 0.0505

==================================================
Epoch 30/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.09it/s, loss=1.4062]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 1.4450
Eval Loss: 1.3263
nDCG@10: 0.0506
Recall@10: 0.0679
✅ Novo melhor modelo salvo! nDCG@10: 0.0506

==================================================
Epoch 31/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.09it/s, loss=1.3628]
Evaluating: 100%
 20/20 [00:02<00:00,  7.66it/s]
Train Loss: 1.4406
Eval Loss: 1.3429
nDCG@10: 0.0504
Recall@10: 0.0677
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0506

==================================================
Epoch 32/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.09it/s, loss=1.3494]
Evaluating: 100%
 20/20 [00:02<00:00,  7.65it/s]
Train Loss: 1.4343
Eval Loss: 1.3544
nDCG@10: 0.0506
Recall@10: 0.0684
⚠️  Sem melhoria por 2 época(s)
   Melhor nDCG@10: 0.0506

==================================================
Epoch 33/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.05it/s, loss=1.5171]
Evaluating: 100%
 20/20 [00:02<00:00,  7.61it/s]
Train Loss: 1.4312
Eval Loss: 1.3675
nDCG@10: 0.0512
Recall@10: 0.0692
✅ Novo melhor modelo salvo! nDCG@10: 0.0512

==================================================
Epoch 34/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.08it/s, loss=1.4096]
Evaluating: 100%
 20/20 [00:02<00:00,  7.68it/s]
Train Loss: 1.4258
Eval Loss: 1.3825
nDCG@10: 0.0513
Recall@10: 0.0703
✅ Novo melhor modelo salvo! nDCG@10: 0.0513

==================================================
Epoch 35/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.09it/s, loss=1.4356]
Evaluating: 100%
 20/20 [00:02<00:00,  7.63it/s]
Train Loss: 1.4254
Eval Loss: 1.3854
nDCG@10: 0.0515
Recall@10: 0.0690
✅ Novo melhor modelo salvo! nDCG@10: 0.0515

==================================================
Epoch 36/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.05it/s, loss=1.4253]
Evaluating: 100%
 20/20 [00:02<00:00,  7.62it/s]
Train Loss: 1.4195
Eval Loss: 1.3962
nDCG@10: 0.0515
Recall@10: 0.0692
✅ Novo melhor modelo salvo! nDCG@10: 0.0515

==================================================
Epoch 37/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.09it/s, loss=1.4493]
Evaluating: 100%
 20/20 [00:02<00:00,  7.66it/s]
Train Loss: 1.4159
Eval Loss: 1.3997
nDCG@10: 0.0520
Recall@10: 0.0710
✅ Novo melhor modelo salvo! nDCG@10: 0.0520

==================================================
Epoch 38/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.09it/s, loss=1.5786]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]
Train Loss: 1.4105
Eval Loss: 1.4151
nDCG@10: 0.0526
Recall@10: 0.0721
✅ Novo melhor modelo salvo! nDCG@10: 0.0526

==================================================
Epoch 39/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.07it/s, loss=1.4169]
Evaluating: 100%
 20/20 [00:02<00:00,  7.61it/s]
Train Loss: 1.4105
Eval Loss: 1.4079
nDCG@10: 0.0527
Recall@10: 0.0717
✅ Novo melhor modelo salvo! nDCG@10: 0.0527

==================================================
Epoch 40/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.03it/s, loss=1.4493]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]
Train Loss: 1.4088
Eval Loss: 1.4073
nDCG@10: 0.0522
Recall@10: 0.0712
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0527

==================================================
Epoch 41/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.06it/s, loss=1.4677]
Evaluating: 100%
 20/20 [00:02<00:00,  7.66it/s]
Train Loss: 1.4035
Eval Loss: 1.4189
nDCG@10: 0.0528
Recall@10: 0.0719
✅ Novo melhor modelo salvo! nDCG@10: 0.0528

==================================================
Epoch 42/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.06it/s, loss=1.3579]
Evaluating: 100%
 20/20 [00:02<00:00,  7.63it/s]
Train Loss: 1.4029
Eval Loss: 1.4405
nDCG@10: 0.0529
Recall@10: 0.0718
✅ Novo melhor modelo salvo! nDCG@10: 0.0529

==================================================
Epoch 43/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.06it/s, loss=1.2983]
Evaluating: 100%
 20/20 [00:02<00:00,  7.50it/s]
Train Loss: 1.3991
Eval Loss: 1.4308
nDCG@10: 0.0529
Recall@10: 0.0721
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0529

==================================================
Epoch 44/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.04it/s, loss=1.4693]
Evaluating: 100%
 20/20 [00:02<00:00,  7.65it/s]
Train Loss: 1.3968
Eval Loss: 1.4424
nDCG@10: 0.0533
Recall@10: 0.0722
✅ Novo melhor modelo salvo! nDCG@10: 0.0533

==================================================
Epoch 45/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.04it/s, loss=1.4391]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]
Train Loss: 1.3980
Eval Loss: 1.4299
nDCG@10: 0.0532
Recall@10: 0.0719
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0533

==================================================
Epoch 46/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.06it/s, loss=1.3614]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 1.3977
Eval Loss: 1.4523
nDCG@10: 0.0528
Recall@10: 0.0704
⚠️  Sem melhoria por 2 época(s)
   Melhor nDCG@10: 0.0533

==================================================
Epoch 47/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.05it/s, loss=1.4403]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]
Train Loss: 1.3942
Eval Loss: 1.4459
nDCG@10: 0.0532
Recall@10: 0.0716
⚠️  Sem melhoria por 3 época(s)
   Melhor nDCG@10: 0.0533

==================================================
Epoch 48/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.05it/s, loss=1.4326]
Evaluating: 100%
 20/20 [00:02<00:00,  7.61it/s]
Train Loss: 1.3931
Eval Loss: 1.4536
nDCG@10: 0.0535
Recall@10: 0.0721
✅ Novo melhor modelo salvo! nDCG@10: 0.0535

==================================================
Epoch 49/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.05it/s, loss=1.3939]
Evaluating: 100%
 20/20 [00:02<00:00,  7.61it/s]
Train Loss: 1.3922
Eval Loss: 1.4525
nDCG@10: 0.0533
Recall@10: 0.0718
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0535

==================================================
Epoch 50/50
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.07it/s, loss=1.4617]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 1.3940
Eval Loss: 1.4521
nDCG@10: 0.0534
Recall@10: 0.0718
⚠️  Sem melhoria por 2 época(s)
   Melhor nDCG@10: 0.0535