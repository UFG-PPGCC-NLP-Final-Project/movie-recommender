============================================================
EXPERIMENTO 2: SBERT + RNN (features colaborativas)
============================================================

Calculando pos_weight para balancear classes...
  • Amostras analisadas: 3,200
  • Labels positivos: 9,918.0
  • Labels negativos: 21,225,282.0
  • Taxa de positivos: 0.0467%
  • pos_weight calculado: 2140.1

==================================================
Epoch 1/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=1.2882]
Evaluating: 100%
 20/20 [00:02<00:00,  7.39it/s]
Train Loss: 1.3780
Eval Loss: 1.3626
nDCG@10: 0.0007
Recall@10: 0.0011
✅ Novo melhor modelo salvo! nDCG@10: 0.0007

==================================================
Epoch 2/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=1.1995]
Evaluating: 100%
 20/20 [00:02<00:00,  7.40it/s]
Train Loss: 1.3361
Eval Loss: 1.2813
nDCG@10: 0.0285
Recall@10: 0.0353
✅ Novo melhor modelo salvo! nDCG@10: 0.0285

==================================================
Epoch 3/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.03it/s, loss=1.0780]
Evaluating: 100%
 20/20 [00:02<00:00,  7.40it/s]
Train Loss: 1.2246
Eval Loss: 1.1744
nDCG@10: 0.0348
Recall@10: 0.0534
✅ Novo melhor modelo salvo! nDCG@10: 0.0348

==================================================
Epoch 4/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.93it/s, loss=1.0671]
Evaluating: 100%
 20/20 [00:02<00:00,  7.34it/s]
Train Loss: 1.0760
Eval Loss: 1.1143
nDCG@10: 0.0367
Recall@10: 0.0574
✅ Novo melhor modelo salvo! nDCG@10: 0.0367

==================================================
Epoch 5/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.94it/s, loss=1.0328]
Evaluating: 100%
 20/20 [00:02<00:00,  7.43it/s]
Train Loss: 0.9768
Eval Loss: 1.1167
nDCG@10: 0.0400
Recall@10: 0.0618
✅ Novo melhor modelo salvo! nDCG@10: 0.0400

==================================================
Epoch 6/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.95it/s, loss=0.9110]
Evaluating: 100%
 20/20 [00:02<00:00,  7.40it/s]
Train Loss: 0.9283
Eval Loss: 1.1350
nDCG@10: 0.0431
Recall@10: 0.0664
✅ Novo melhor modelo salvo! nDCG@10: 0.0431

==================================================
Epoch 7/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.92it/s, loss=1.0271]
Evaluating: 100%
 20/20 [00:02<00:00,  7.44it/s]
Train Loss: 0.9005
Eval Loss: 1.1547
nDCG@10: 0.0425
Recall@10: 0.0644
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0431

==================================================
Epoch 8/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.93it/s, loss=0.8193]
Evaluating: 100%
 20/20 [00:02<00:00,  7.37it/s]
Train Loss: 0.8809
Eval Loss: 1.1671
nDCG@10: 0.0423
Recall@10: 0.0647
⚠️  Sem melhoria por 2 época(s)
   Melhor nDCG@10: 0.0431

==================================================
Epoch 9/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.95it/s, loss=0.8010]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]
Train Loss: 0.8653
Eval Loss: 1.1797
nDCG@10: 0.0431
Recall@10: 0.0647
⚠️  Sem melhoria por 3 época(s)
   Melhor nDCG@10: 0.0431

==================================================
Epoch 10/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.00it/s, loss=0.7758]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]
Train Loss: 0.8513
Eval Loss: 1.1763
nDCG@10: 0.0455
Recall@10: 0.0664
✅ Novo melhor modelo salvo! nDCG@10: 0.0455

==================================================
Epoch 11/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.97it/s, loss=0.9053]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]
Train Loss: 0.8399
Eval Loss: 1.1786
nDCG@10: 0.0466
Recall@10: 0.0670
✅ Novo melhor modelo salvo! nDCG@10: 0.0466

==================================================
Epoch 12/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.99it/s, loss=0.8331]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]
Train Loss: 0.8273
Eval Loss: 1.2006
nDCG@10: 0.0483
Recall@10: 0.0675
✅ Novo melhor modelo salvo! nDCG@10: 0.0483

==================================================
Epoch 13/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.92it/s, loss=0.9181]
Evaluating: 100%
 20/20 [00:02<00:00,  7.40it/s]
Train Loss: 0.8187
Eval Loss: 1.2066
nDCG@10: 0.0495
Recall@10: 0.0673
✅ Novo melhor modelo salvo! nDCG@10: 0.0495

==================================================
Epoch 14/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.92it/s, loss=0.8447]
Evaluating: 100%
 20/20 [00:02<00:00,  7.36it/s]
Train Loss: 0.8125
Eval Loss: 1.2306
nDCG@10: 0.0491
Recall@10: 0.0639
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0495

==================================================
Epoch 15/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.04it/s, loss=0.7011]
Evaluating: 100%
 20/20 [00:02<00:00,  7.38it/s]
Train Loss: 0.8047
Eval Loss: 1.2477
nDCG@10: 0.0495
Recall@10: 0.0643
✅ Novo melhor modelo salvo! nDCG@10: 0.0495

==================================================
Epoch 16/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.7850]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]
Train Loss: 0.7966
Eval Loss: 1.2668
nDCG@10: 0.0500
Recall@10: 0.0651
✅ Novo melhor modelo salvo! nDCG@10: 0.0500

==================================================
Epoch 17/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.8185]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]
Train Loss: 0.7925
Eval Loss: 1.2666
nDCG@10: 0.0493
Recall@10: 0.0628
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0500

==================================================
Epoch 18/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.89it/s, loss=0.7593]
Evaluating: 100%
 20/20 [00:02<00:00,  7.34it/s]
Train Loss: 0.7866
Eval Loss: 1.2706
nDCG@10: 0.0496
Recall@10: 0.0646
⚠️  Sem melhoria por 2 época(s)
   Melhor nDCG@10: 0.0500

==================================================
Epoch 19/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.7639]
Evaluating: 100%
 20/20 [00:02<00:00,  7.32it/s]
Train Loss: 0.7820
Eval Loss: 1.2747
nDCG@10: 0.0501
Recall@10: 0.0636
✅ Novo melhor modelo salvo! nDCG@10: 0.0501

==================================================
Epoch 20/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.00it/s, loss=0.8016]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]
Train Loss: 0.7777
Eval Loss: 1.2756
nDCG@10: 0.0501
Recall@10: 0.0646
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0501

==================================================
Epoch 21/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.7504]
Evaluating: 100%
 20/20 [00:02<00:00,  7.45it/s]
Train Loss: 0.7754
Eval Loss: 1.2933
nDCG@10: 0.0508
Recall@10: 0.0660
✅ Novo melhor modelo salvo! nDCG@10: 0.0508

==================================================
Epoch 22/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.6780]
Evaluating: 100%
 20/20 [00:02<00:00,  7.52it/s]
Train Loss: 0.7705
Eval Loss: 1.2987
nDCG@10: 0.0508
Recall@10: 0.0650
✅ Novo melhor modelo salvo! nDCG@10: 0.0508

==================================================
Epoch 23/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.96it/s, loss=0.6868]
Evaluating: 100%
 20/20 [00:02<00:00,  7.51it/s]
Train Loss: 0.7687
Eval Loss: 1.3260
nDCG@10: 0.0509
Recall@10: 0.0661
✅ Novo melhor modelo salvo! nDCG@10: 0.0509

==================================================
Epoch 24/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.03it/s, loss=0.8213]
Evaluating: 100%
 20/20 [00:02<00:00,  7.35it/s]
Train Loss: 0.7646
Eval Loss: 1.3306
nDCG@10: 0.0509
Recall@10: 0.0661
✅ Novo melhor modelo salvo! nDCG@10: 0.0509

==================================================
Epoch 25/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.7181]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]
Train Loss: 0.7634
Eval Loss: 1.3336
nDCG@10: 0.0512
Recall@10: 0.0661
✅ Novo melhor modelo salvo! nDCG@10: 0.0512

==================================================
Epoch 26/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.99it/s, loss=0.7443]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]
Train Loss: 0.7621
Eval Loss: 1.3289
nDCG@10: 0.0521
Recall@10: 0.0672
✅ Novo melhor modelo salvo! nDCG@10: 0.0521

==================================================
Epoch 27/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.93it/s, loss=0.7787]
Evaluating: 100%
 20/20 [00:02<00:00,  7.50it/s]
Train Loss: 0.7591
Eval Loss: 1.3450
nDCG@10: 0.0518
Recall@10: 0.0666
⚠️  Sem melhoria por 1 época(s)
   Melhor nDCG@10: 0.0521

==================================================
Epoch 28/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.85it/s, loss=0.8940]
Evaluating: 100%
 20/20 [00:02<00:00,  7.34it/s]
Train Loss: 0.7574
Eval Loss: 1.3476
nDCG@10: 0.0515
Recall@10: 0.0659
⚠️  Sem melhoria por 2 época(s)
   Melhor nDCG@10: 0.0521

==================================================
Epoch 29/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.05it/s, loss=0.8336]
Evaluating: 100%
 20/20 [00:02<00:00,  7.32it/s]
Train Loss: 0.7565
Eval Loss: 1.3516
nDCG@10: 0.0514
Recall@10: 0.0666
⚠️  Sem melhoria por 3 época(s)
   Melhor nDCG@10: 0.0521

==================================================
Epoch 30/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.98it/s, loss=0.7239]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]
Train Loss: 0.7561
Eval Loss: 1.3491
nDCG@10: 0.0516
Recall@10: 0.0665
⚠️  Sem melhoria por 4 época(s)
   Melhor nDCG@10: 0.0521