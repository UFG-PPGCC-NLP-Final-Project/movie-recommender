============================================================
EXPERIMENTO 1: SBERT Baseline (sem RNN, sem multi-task)
============================================================
config.json: 100%
 612/612 [00:00<00:00, 77.1kB/s]
model.safetensors: 100%
 90.9M/90.9M [00:00<00:00, 138MB/s]

Calculando pos_weight para balancear classes...
  • Amostras analisadas: 3,200
  • Labels positivos: 9,699.0
  • Labels negativos: 21,225,500.0
  • Taxa de positivos: 0.0457%
  • pos_weight calculado: 2188.4

==================================================
Epoch 1/30
==================================================
Training: 100%
 292/292 [00:43<00:00,  7.04it/s, loss=1.3504]
Evaluating: 100%
 20/20 [00:02<00:00,  7.62it/s]

Train Loss: 1.3925
Eval Loss: 1.3760
nDCG@10: 0.0017
Recall@10: 0.0024
Novo melhor modelo salvo! nDCG@10: 0.0017

==================================================
Epoch 2/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.06it/s, loss=1.4499]
Evaluating: 100%
 20/20 [00:02<00:00,  7.62it/s]

Train Loss: 1.3402
Eval Loss: 1.2861
nDCG@10: 0.0224
Recall@10: 0.0407
Novo melhor modelo salvo! nDCG@10: 0.0224

==================================================
Epoch 3/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.03it/s, loss=1.2778]
Evaluating: 100%
 20/20 [00:02<00:00,  7.61it/s]

Train Loss: 1.2183
Eval Loss: 1.1818
nDCG@10: 0.0338
Recall@10: 0.0458
Novo melhor modelo salvo! nDCG@10: 0.0338

==================================================
Epoch 4/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.04it/s, loss=1.0538]
Evaluating: 100%
 20/20 [00:02<00:00,  7.64it/s]

Train Loss: 1.0806
Eval Loss: 1.1365
nDCG@10: 0.0414
Recall@10: 0.0536
Novo melhor modelo salvo! nDCG@10: 0.0414

==================================================
Epoch 5/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.01it/s, loss=1.0043]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]

Train Loss: 0.9943
Eval Loss: 1.1385
nDCG@10: 0.0420
Recall@10: 0.0559
Novo melhor modelo salvo! nDCG@10: 0.0420

==================================================
Epoch 6/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.05it/s, loss=1.0133]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]

Train Loss: 0.9495
Eval Loss: 1.1540
nDCG@10: 0.0437
Recall@10: 0.0601
Novo melhor modelo salvo! nDCG@10: 0.0437

==================================================
Epoch 7/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.06it/s, loss=0.8903]
Evaluating: 100%
 20/20 [00:02<00:00,  7.61it/s]

Train Loss: 0.9183
Eval Loss: 1.1703
nDCG@10: 0.0445
Recall@10: 0.0604
Novo melhor modelo salvo! nDCG@10: 0.0445

==================================================
Epoch 8/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.04it/s, loss=0.8832]
Evaluating: 100%
 20/20 [00:02<00:00,  7.63it/s]

Train Loss: 0.8995
Eval Loss: 1.1715
nDCG@10: 0.0452
Recall@10: 0.0599
Novo melhor modelo salvo! nDCG@10: 0.0452

==================================================
Epoch 9/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.05it/s, loss=0.7973]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]

Train Loss: 0.8839
Eval Loss: 1.2018
nDCG@10: 0.0437
Recall@10: 0.0598

==================================================
Epoch 10/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.03it/s, loss=0.7658]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 0.8685
Eval Loss: 1.2068
nDCG@10: 0.0439
Recall@10: 0.0598

==================================================
Epoch 11/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.04it/s, loss=0.8904]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 0.8544
Eval Loss: 1.2219
nDCG@10: 0.0464
Recall@10: 0.0603
Novo melhor modelo salvo! nDCG@10: 0.0464

==================================================
Epoch 12/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.02it/s, loss=0.8732]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 0.8435
Eval Loss: 1.2158
nDCG@10: 0.0467
Recall@10: 0.0605
Novo melhor modelo salvo! nDCG@10: 0.0467

==================================================
Epoch 13/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.04it/s, loss=0.7711]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 0.8343
Eval Loss: 1.2445
nDCG@10: 0.0476
Recall@10: 0.0606
Novo melhor modelo salvo! nDCG@10: 0.0476

==================================================
Epoch 14/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.98it/s, loss=0.6698]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]

Train Loss: 0.8252
Eval Loss: 1.2436
nDCG@10: 0.0479
Recall@10: 0.0614
Novo melhor modelo salvo! nDCG@10: 0.0479

==================================================
Epoch 15/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.06it/s, loss=0.9053]
Evaluating: 100%
 20/20 [00:02<00:00,  7.51it/s]

Train Loss: 0.8186
Eval Loss: 1.2602
nDCG@10: 0.0482
Recall@10: 0.0624
Novo melhor modelo salvo! nDCG@10: 0.0482

==================================================
Epoch 16/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.00it/s, loss=0.6969]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]

Train Loss: 0.8126
Eval Loss: 1.2798
nDCG@10: 0.0476
Recall@10: 0.0611

==================================================
Epoch 17/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.07it/s, loss=0.9272]
Evaluating: 100%
 20/20 [00:02<00:00,  7.62it/s]

Train Loss: 0.8060
Eval Loss: 1.2847
nDCG@10: 0.0485
Recall@10: 0.0633
Novo melhor modelo salvo! nDCG@10: 0.0485

==================================================
Epoch 18/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.05it/s, loss=0.7937]
Evaluating: 100%
 20/20 [00:02<00:00,  7.63it/s]

Train Loss: 0.8031
Eval Loss: 1.2876
nDCG@10: 0.0481
Recall@10: 0.0644

==================================================
Epoch 19/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.01it/s, loss=0.7223]
Evaluating: 100%
 20/20 [00:02<00:00,  7.65it/s]

Train Loss: 0.7942
Eval Loss: 1.3090
nDCG@10: 0.0487
Recall@10: 0.0643
Novo melhor modelo salvo! nDCG@10: 0.0487

==================================================
Epoch 20/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.07it/s, loss=0.8100]
Evaluating: 100%
 20/20 [00:02<00:00,  7.50it/s]

Train Loss: 0.7907
Eval Loss: 1.3106
nDCG@10: 0.0485
Recall@10: 0.0649

==================================================
Epoch 21/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.04it/s, loss=0.7502]
Evaluating: 100%
 20/20 [00:02<00:00,  7.65it/s]

Train Loss: 0.7872
Eval Loss: 1.3246
nDCG@10: 0.0485
Recall@10: 0.0651

==================================================
Epoch 22/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.05it/s, loss=0.7915]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]

Train Loss: 0.7840
Eval Loss: 1.3558
nDCG@10: 0.0486
Recall@10: 0.0648

==================================================
Epoch 23/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.04it/s, loss=0.7297]
Evaluating: 100%
 20/20 [00:02<00:00,  7.50it/s]

Train Loss: 0.7798
Eval Loss: 1.3301
nDCG@10: 0.0493
Recall@10: 0.0655
Novo melhor modelo salvo! nDCG@10: 0.0493

==================================================
Epoch 24/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.7382]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]

Train Loss: 0.7779
Eval Loss: 1.3568
nDCG@10: 0.0483
Recall@10: 0.0662

==================================================
Epoch 25/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.7871]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]

Train Loss: 0.7757
Eval Loss: 1.3466
nDCG@10: 0.0497
Recall@10: 0.0671
Novo melhor modelo salvo! nDCG@10: 0.0497

==================================================
Epoch 26/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.06it/s, loss=0.8468]
Evaluating: 100%
 20/20 [00:02<00:00,  7.62it/s]

Train Loss: 0.7735
Eval Loss: 1.3494
nDCG@10: 0.0497
Recall@10: 0.0668
Novo melhor modelo salvo! nDCG@10: 0.0497

==================================================
Epoch 27/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.05it/s, loss=0.8393]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]

Train Loss: 0.7723
Eval Loss: 1.3729
nDCG@10: 0.0500
Recall@10: 0.0668
Novo melhor modelo salvo! nDCG@10: 0.0500

==================================================
Epoch 28/30
==================================================
Training: 100%
 292/292 [00:41<00:00,  7.04it/s, loss=0.7208]
Evaluating: 100%
 20/20 [00:02<00:00,  7.50it/s]

Train Loss: 0.7704
Eval Loss: 1.3632
nDCG@10: 0.0501
Recall@10: 0.0677
Novo melhor modelo salvo! nDCG@10: 0.0501

==================================================
Epoch 29/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.06it/s, loss=0.7831]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]

Train Loss: 0.7704
Eval Loss: 1.3716
nDCG@10: 0.0496
Recall@10: 0.0672

==================================================
Epoch 30/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.04it/s, loss=0.7025]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]

Train Loss: 0.7701
Eval Loss: 1.3704
nDCG@10: 0.0500
Recall@10: 0.0680