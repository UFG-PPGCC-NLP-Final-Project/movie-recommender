============================================================
EXPERIMENTO 3: SBERT + Multi-Task (user tags)
============================================================

Calculando pos_weight para balancear classes...
  • Amostras analisadas: 3,200
  • Labels positivos: 9,771.0
  • Labels negativos: 21,225,428.0
  • Taxa de positivos: 0.0460%
  • pos_weight calculado: 2172.3

==================================================
Epoch 1/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.03it/s, loss=10.1035]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 10.1887
Eval Loss: 1.3776
nDCG@10: 0.0008
Recall@10: 0.0018
Novo melhor modelo salvo! nDCG@10: 0.0008

==================================================
Epoch 2/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.01it/s, loss=9.9284]
Evaluating: 100%
 20/20 [00:02<00:00,  7.44it/s]

Train Loss: 10.1292
Eval Loss: 1.3225
nDCG@10: 0.0240
Recall@10: 0.0301
Novo melhor modelo salvo! nDCG@10: 0.0240

==================================================
Epoch 3/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.02it/s, loss=9.3101]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]

Train Loss: 9.7139
Eval Loss: 1.2022
nDCG@10: 0.0368
Recall@10: 0.0502
Novo melhor modelo salvo! nDCG@10: 0.0368

==================================================
Epoch 4/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.03it/s, loss=8.4679]
Evaluating: 100%
 20/20 [00:02<00:00,  7.59it/s]

Train Loss: 8.8803
Eval Loss: 1.1473
nDCG@10: 0.0372
Recall@10: 0.0516
Novo melhor modelo salvo! nDCG@10: 0.0372

==================================================
Epoch 5/30
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.01it/s, loss=8.3292]
Evaluating: 100%
 20/20 [00:02<00:00,  7.51it/s]

Train Loss: 8.3503
Eval Loss: 1.1389
nDCG@10: 0.0410
Recall@10: 0.0614
Novo melhor modelo salvo! nDCG@10: 0.0410

==================================================
Epoch 6/30
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.02it/s, loss=7.8820]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 8.0967
Eval Loss: 1.1472
nDCG@10: 0.0418
Recall@10: 0.0630
Novo melhor modelo salvo! nDCG@10: 0.0418

==================================================
Epoch 7/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.04it/s, loss=7.8440]
Evaluating: 100%
 20/20 [00:02<00:00,  7.47it/s]

Train Loss: 7.9572
Eval Loss: 1.1603
nDCG@10: 0.0423
Recall@10: 0.0630
Novo melhor modelo salvo! nDCG@10: 0.0423

==================================================
Epoch 8/30
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.04it/s, loss=7.8041]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]

Train Loss: 7.8725
Eval Loss: 1.1729
nDCG@10: 0.0426
Recall@10: 0.0630
Novo melhor modelo salvo! nDCG@10: 0.0426

==================================================
Epoch 9/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.02it/s, loss=7.7539]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]

Train Loss: 7.8243
Eval Loss: 1.1874
nDCG@10: 0.0430
Recall@10: 0.0626
Novo melhor modelo salvo! nDCG@10: 0.0430

==================================================
Epoch 10/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.98it/s, loss=7.8681]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]

Train Loss: 7.7757
Eval Loss: 1.1997
nDCG@10: 0.0431
Recall@10: 0.0624
Novo melhor modelo salvo! nDCG@10: 0.0431

==================================================
Epoch 11/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.02it/s, loss=7.6066]
Evaluating: 100%
 20/20 [00:02<00:00,  7.52it/s]

Train Loss: 7.7410
Eval Loss: 1.2118
nDCG@10: 0.0434
Recall@10: 0.0645
Novo melhor modelo salvo! nDCG@10: 0.0434

==================================================
Epoch 12/30
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.06it/s, loss=7.6785]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]

Train Loss: 7.7046
Eval Loss: 1.2191
nDCG@10: 0.0441
Recall@10: 0.0660
Novo melhor modelo salvo! nDCG@10: 0.0441

==================================================
Epoch 13/30
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.01it/s, loss=7.5978]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]

Train Loss: 7.6584
Eval Loss: 1.2299
nDCG@10: 0.0446
Recall@10: 0.0660
Novo melhor modelo salvo! nDCG@10: 0.0446

==================================================
Epoch 14/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.02it/s, loss=7.6807]
Evaluating: 100%
 20/20 [00:02<00:00,  7.52it/s]

Train Loss: 7.6275
Eval Loss: 1.2364
nDCG@10: 0.0445
Recall@10: 0.0660

==================================================
Epoch 15/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.00it/s, loss=7.1977]
Evaluating: 100%
 20/20 [00:02<00:00,  7.59it/s]

Train Loss: 7.5933
Eval Loss: 1.2412
nDCG@10: 0.0450
Recall@10: 0.0660
Novo melhor modelo salvo! nDCG@10: 0.0450

==================================================
Epoch 16/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.97it/s, loss=7.8053]
Evaluating: 100%
 20/20 [00:02<00:00,  7.48it/s]

Train Loss: 7.5558
Eval Loss: 1.2521
nDCG@10: 0.0458
Recall@10: 0.0660
Novo melhor modelo salvo! nDCG@10: 0.0458

==================================================
Epoch 17/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.00it/s, loss=7.2793]
Evaluating: 100%
 20/20 [00:02<00:00,  7.50it/s]

Train Loss: 7.5347
Eval Loss: 1.2552
nDCG@10: 0.0462
Recall@10: 0.0660
Novo melhor modelo salvo! nDCG@10: 0.0462

==================================================
Epoch 18/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.94it/s, loss=7.4255]
Evaluating: 100%
 20/20 [00:02<00:00,  7.35it/s]

Train Loss: 7.5023
Eval Loss: 1.2609
nDCG@10: 0.0461
Recall@10: 0.0660

==================================================
Epoch 19/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.99it/s, loss=7.4121]
Evaluating: 100%
 20/20 [00:02<00:00,  7.49it/s]

Train Loss: 7.4716
Eval Loss: 1.2729
nDCG@10: 0.0462
Recall@10: 0.0660
Novo melhor modelo salvo! nDCG@10: 0.0462

==================================================
Epoch 20/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.03it/s, loss=7.5293]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]

Train Loss: 7.4546
Eval Loss: 1.2751
nDCG@10: 0.0462
Recall@10: 0.0660

==================================================
Epoch 21/30
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.03it/s, loss=7.5711]
Evaluating: 100%
 20/20 [00:02<00:00,  7.50it/s]

Train Loss: 7.4372
Eval Loss: 1.2742
nDCG@10: 0.0462
Recall@10: 0.0660

==================================================
Epoch 22/30
==================================================
Training: 100%
 292/292 [00:48<00:00,  6.01it/s, loss=7.3593]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]

Train Loss: 7.4152
Eval Loss: 1.2834
nDCG@10: 0.0461
Recall@10: 0.0660

==================================================
Epoch 23/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.02it/s, loss=7.7704]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]

Train Loss: 7.3937
Eval Loss: 1.2831
nDCG@10: 0.0461
Recall@10: 0.0660

==================================================
Epoch 24/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.00it/s, loss=7.4301]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]

Train Loss: 7.3813
Eval Loss: 1.2993
nDCG@10: 0.0461
Recall@10: 0.0660

==================================================
Epoch 25/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.02it/s, loss=7.6234]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]

Train Loss: 7.3694
Eval Loss: 1.3008
nDCG@10: 0.0462
Recall@10: 0.0660

==================================================
Epoch 26/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.01it/s, loss=7.3109]
Evaluating: 100%
 20/20 [00:02<00:00,  7.49it/s]

Train Loss: 7.3528
Eval Loss: 1.3196
nDCG@10: 0.0462
Recall@10: 0.0660

==================================================
Epoch 27/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.02it/s, loss=7.4117]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]

Train Loss: 7.3555
Eval Loss: 1.3146
nDCG@10: 0.0460
Recall@10: 0.0658

==================================================
Epoch 28/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.03it/s, loss=7.2146]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]

Train Loss: 7.3383
Eval Loss: 1.3182
nDCG@10: 0.0460
Recall@10: 0.0658

==================================================
Epoch 29/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.95it/s, loss=7.2522]
Evaluating: 100%
 20/20 [00:02<00:00,  7.46it/s]

Train Loss: 7.3403
Eval Loss: 1.3175
nDCG@10: 0.0461
Recall@10: 0.0658

==================================================
Epoch 30/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.04it/s, loss=7.1425]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 7.3419
Eval Loss: 1.3156
nDCG@10: 0.0461
Recall@10: 0.0658