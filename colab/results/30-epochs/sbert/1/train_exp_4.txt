============================================================
EXPERIMENTO 4: SBERT + RNN + Multi-Task (modelo completo)
============================================================

Calculando pos_weight para balancear classes...
  • Amostras analisadas: 3,200
  • Labels positivos: 9,792.0
  • Labels negativos: 21,225,408.0
  • Taxa de positivos: 0.0461%
  • pos_weight calculado: 2167.6

==================================================
Epoch 1/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.00it/s, loss=10.0569]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]

Train Loss: 10.1859
Eval Loss: 1.3744
nDCG@10: 0.0014
Recall@10: 0.0025
Novo melhor modelo salvo! nDCG@10: 0.0014

==================================================
Epoch 2/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.96it/s, loss=10.0791]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 10.1259
Eval Loss: 1.3240
nDCG@10: 0.0129
Recall@10: 0.0186
Novo melhor modelo salvo! nDCG@10: 0.0129

==================================================
Epoch 3/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.98it/s, loss=9.3307]
Evaluating: 100%
 20/20 [00:02<00:00,  7.49it/s]

Train Loss: 9.7091
Eval Loss: 1.1943
nDCG@10: 0.0243
Recall@10: 0.0416
Novo melhor modelo salvo! nDCG@10: 0.0243

==================================================
Epoch 4/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.95it/s, loss=8.5268]
Evaluating: 100%
 20/20 [00:02<00:00,  7.51it/s]

Train Loss: 8.9139
Eval Loss: 1.1242
nDCG@10: 0.0312
Recall@10: 0.0467
Novo melhor modelo salvo! nDCG@10: 0.0312

==================================================
Epoch 5/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.97it/s, loss=8.2633]
Evaluating: 100%
 20/20 [00:02<00:00,  7.49it/s]

Train Loss: 8.3653
Eval Loss: 1.1148
nDCG@10: 0.0326
Recall@10: 0.0463
Novo melhor modelo salvo! nDCG@10: 0.0326

==================================================
Epoch 6/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.99it/s, loss=8.1655]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]

Train Loss: 8.0986
Eval Loss: 1.1268
nDCG@10: 0.0374
Recall@10: 0.0574
Novo melhor modelo salvo! nDCG@10: 0.0374

==================================================
Epoch 7/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.98it/s, loss=7.9638]
Evaluating: 100%
 20/20 [00:02<00:00,  7.52it/s]

Train Loss: 7.9509
Eval Loss: 1.1445
nDCG@10: 0.0434
Recall@10: 0.0622
Novo melhor modelo salvo! nDCG@10: 0.0434

==================================================
Epoch 8/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.98it/s, loss=7.8863]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]

Train Loss: 7.8617
Eval Loss: 1.1614
nDCG@10: 0.0475
Recall@10: 0.0621
Novo melhor modelo salvo! nDCG@10: 0.0475

==================================================
Epoch 9/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.99it/s, loss=7.8016]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]

Train Loss: 7.8050
Eval Loss: 1.1780
nDCG@10: 0.0480
Recall@10: 0.0650
Novo melhor modelo salvo! nDCG@10: 0.0480

==================================================
Epoch 10/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.97it/s, loss=7.6398]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]

Train Loss: 7.7649
Eval Loss: 1.1925
nDCG@10: 0.0492
Recall@10: 0.0664
Novo melhor modelo salvo! nDCG@10: 0.0492

==================================================
Epoch 11/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.95it/s, loss=7.7286]
Evaluating: 100%
 20/20 [00:02<00:00,  7.52it/s]

Train Loss: 7.7208
Eval Loss: 1.2062
nDCG@10: 0.0520
Recall@10: 0.0705
Novo melhor modelo salvo! nDCG@10: 0.0520

==================================================
Epoch 12/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.95it/s, loss=7.5221]
Evaluating: 100%
 20/20 [00:02<00:00,  7.51it/s]

Train Loss: 7.6829
Eval Loss: 1.2118
nDCG@10: 0.0521
Recall@10: 0.0706
Novo melhor modelo salvo! nDCG@10: 0.0521

==================================================
Epoch 13/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.94it/s, loss=7.4298]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]

Train Loss: 7.6444
Eval Loss: 1.2215
nDCG@10: 0.0503
Recall@10: 0.0713

==================================================
Epoch 14/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.97it/s, loss=7.3700]
Evaluating: 100%
 20/20 [00:02<00:00,  7.46it/s]

Train Loss: 7.6172
Eval Loss: 1.2278
nDCG@10: 0.0501
Recall@10: 0.0713

==================================================
Epoch 15/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.98it/s, loss=7.6972]
Evaluating: 100%
 20/20 [00:02<00:00,  7.52it/s]

Train Loss: 7.5751
Eval Loss: 1.2350
nDCG@10: 0.0500
Recall@10: 0.0713

==================================================
Epoch 16/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.98it/s, loss=7.7817]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 7.5484
Eval Loss: 1.2497
nDCG@10: 0.0499
Recall@10: 0.0713

==================================================
Epoch 17/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.98it/s, loss=7.4227]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]

Train Loss: 7.5147
Eval Loss: 1.2564
nDCG@10: 0.0497
Recall@10: 0.0713

==================================================
Epoch 18/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.98it/s, loss=7.4808]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]

Train Loss: 7.4834
Eval Loss: 1.2627
nDCG@10: 0.0494
Recall@10: 0.0713

==================================================
Epoch 19/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.99it/s, loss=7.4887]
Evaluating: 100%
 20/20 [00:02<00:00,  7.49it/s]

Train Loss: 7.4651
Eval Loss: 1.2708
nDCG@10: 0.0490
Recall@10: 0.0712

==================================================
Epoch 20/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.97it/s, loss=7.6377]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]

Train Loss: 7.4398
Eval Loss: 1.2733
nDCG@10: 0.0491
Recall@10: 0.0712

==================================================
Epoch 21/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.00it/s, loss=7.4618]
Evaluating: 100%
 20/20 [00:02<00:00,  7.51it/s]

Train Loss: 7.4194
Eval Loss: 1.2982
nDCG@10: 0.0490
Recall@10: 0.0706

==================================================
Epoch 22/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.94it/s, loss=7.2789]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]

Train Loss: 7.4069
Eval Loss: 1.2927
nDCG@10: 0.0488
Recall@10: 0.0696

==================================================
Epoch 23/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.99it/s, loss=7.3313]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]

Train Loss: 7.3898
Eval Loss: 1.3037
nDCG@10: 0.0482
Recall@10: 0.0684

==================================================
Epoch 24/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.97it/s, loss=7.3523]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]

Train Loss: 7.3709
Eval Loss: 1.3127
nDCG@10: 0.0478
Recall@10: 0.0677

==================================================
Epoch 25/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.01it/s, loss=7.7238]
Evaluating: 100%
 20/20 [00:02<00:00,  7.51it/s]

Train Loss: 7.3632
Eval Loss: 1.3053
nDCG@10: 0.0478
Recall@10: 0.0677

==================================================
Epoch 26/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.98it/s, loss=7.3074]
Evaluating: 100%
 20/20 [00:02<00:00,  7.49it/s]

Train Loss: 7.3518
Eval Loss: 1.2994
nDCG@10: 0.0479
Recall@10: 0.0678

==================================================
Epoch 27/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.00it/s, loss=7.1005]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]

Train Loss: 7.3395
Eval Loss: 1.3288
nDCG@10: 0.0476
Recall@10: 0.0676

==================================================
Epoch 28/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.96it/s, loss=7.1075]
Evaluating: 100%
 20/20 [00:02<00:00,  7.42it/s]

Train Loss: 7.3310
Eval Loss: 1.3252
nDCG@10: 0.0477
Recall@10: 0.0678

==================================================
Epoch 29/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  6.01it/s, loss=7.4214]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 7.3250
Eval Loss: 1.3276
nDCG@10: 0.0476
Recall@10: 0.0676

==================================================
Epoch 30/30
==================================================
Training: 100%
 292/292 [00:49<00:00,  5.96it/s, loss=7.1944]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 7.3198
Eval Loss: 1.3250
nDCG@10: 0.0476
Recall@10: 0.0676