============================================================
EXPERIMENTO 2: SBERT + RNN (features colaborativas)
============================================================

Calculando pos_weight para balancear classes...
  • Amostras analisadas: 3,200
  • Labels positivos: 9,734.0
  • Labels negativos: 21,225,466.0
  • Taxa de positivos: 0.0458%
  • pos_weight calculado: 2180.5

==================================================
Epoch 1/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.97it/s, loss=1.4657]
Evaluating: 100%
 20/20 [00:02<00:00,  7.56it/s]

Train Loss: 1.3926
Eval Loss: 1.3813
nDCG@10: 0.0004
Recall@10: 0.0003
Novo melhor modelo salvo! nDCG@10: 0.0004

==================================================
Epoch 2/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.99it/s, loss=1.2772]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]

Train Loss: 1.3502
Eval Loss: 1.3025
nDCG@10: 0.0111
Recall@10: 0.0169
Novo melhor modelo salvo! nDCG@10: 0.0111

==================================================
Epoch 3/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=1.1411]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]

Train Loss: 1.2272
Eval Loss: 1.1975
nDCG@10: 0.0231
Recall@10: 0.0397
Novo melhor modelo salvo! nDCG@10: 0.0231

==================================================
Epoch 4/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.06it/s, loss=0.9846]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]

Train Loss: 1.0739
Eval Loss: 1.1459
nDCG@10: 0.0365
Recall@10: 0.0447
Novo melhor modelo salvo! nDCG@10: 0.0365

==================================================
Epoch 5/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.9296]
Evaluating: 100%
 20/20 [00:02<00:00,  7.49it/s]

Train Loss: 0.9780
Eval Loss: 1.1528
nDCG@10: 0.0392
Recall@10: 0.0496
Novo melhor modelo salvo! nDCG@10: 0.0392

==================================================
Epoch 6/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.96it/s, loss=0.9126]
Evaluating: 100%
 20/20 [00:02<00:00,  7.52it/s]

Train Loss: 0.9305
Eval Loss: 1.1727
nDCG@10: 0.0396
Recall@10: 0.0502
Novo melhor modelo salvo! nDCG@10: 0.0396

==================================================
Epoch 7/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.7980]
Evaluating: 100%
 20/20 [00:02<00:00,  7.52it/s]

Train Loss: 0.9021
Eval Loss: 1.1960
nDCG@10: 0.0405
Recall@10: 0.0521
Novo melhor modelo salvo! nDCG@10: 0.0405

==================================================
Epoch 8/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.05it/s, loss=0.8480]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 0.8858
Eval Loss: 1.2125
nDCG@10: 0.0449
Recall@10: 0.0629
Novo melhor modelo salvo! nDCG@10: 0.0449

==================================================
Epoch 9/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.8421]
Evaluating: 100%
 20/20 [00:02<00:00,  7.61it/s]

Train Loss: 0.8726
Eval Loss: 1.2120
nDCG@10: 0.0459
Recall@10: 0.0648
Novo melhor modelo salvo! nDCG@10: 0.0459

==================================================
Epoch 10/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.00it/s, loss=0.7731]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]

Train Loss: 0.8595
Eval Loss: 1.2265
nDCG@10: 0.0440
Recall@10: 0.0600

==================================================
Epoch 11/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.04it/s, loss=0.7964]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]

Train Loss: 0.8463
Eval Loss: 1.2534
nDCG@10: 0.0461
Recall@10: 0.0643
Novo melhor modelo salvo! nDCG@10: 0.0461

==================================================
Epoch 12/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.9606]
Evaluating: 100%
 20/20 [00:02<00:00,  7.60it/s]

Train Loss: 0.8361
Eval Loss: 1.2488
nDCG@10: 0.0463
Recall@10: 0.0652
Novo melhor modelo salvo! nDCG@10: 0.0463

==================================================
Epoch 13/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.00it/s, loss=0.8160]
Evaluating: 100%
 20/20 [00:02<00:00,  7.49it/s]

Train Loss: 0.8271
Eval Loss: 1.2687
nDCG@10: 0.0456
Recall@10: 0.0630

==================================================
Epoch 14/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.98it/s, loss=0.7792]
Evaluating: 100%
 20/20 [00:02<00:00,  7.53it/s]

Train Loss: 0.8195
Eval Loss: 1.2476
nDCG@10: 0.0459
Recall@10: 0.0635

==================================================
Epoch 15/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.04it/s, loss=0.8535]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]

Train Loss: 0.8129
Eval Loss: 1.3042
nDCG@10: 0.0460
Recall@10: 0.0635

==================================================
Epoch 16/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.8544]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]

Train Loss: 0.8053
Eval Loss: 1.3005
nDCG@10: 0.0471
Recall@10: 0.0631
Novo melhor modelo salvo! nDCG@10: 0.0471

==================================================
Epoch 17/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.00it/s, loss=0.8263]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]

Train Loss: 0.8008
Eval Loss: 1.3216
nDCG@10: 0.0471
Recall@10: 0.0636
Novo melhor modelo salvo! nDCG@10: 0.0471

==================================================
Epoch 18/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.7690]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]

Train Loss: 0.7957
Eval Loss: 1.3159
nDCG@10: 0.0478
Recall@10: 0.0643
Novo melhor modelo salvo! nDCG@10: 0.0478

==================================================
Epoch 19/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.8121]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]

Train Loss: 0.7917
Eval Loss: 1.3292
nDCG@10: 0.0474
Recall@10: 0.0635

==================================================
Epoch 20/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.94it/s, loss=0.6707]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 0.7879
Eval Loss: 1.3151
nDCG@10: 0.0480
Recall@10: 0.0642
Novo melhor modelo salvo! nDCG@10: 0.0480

==================================================
Epoch 21/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.98it/s, loss=0.7539]
Evaluating: 100%
 20/20 [00:02<00:00,  7.51it/s]

Train Loss: 0.7829
Eval Loss: 1.3616
nDCG@10: 0.0471
Recall@10: 0.0625

==================================================
Epoch 22/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.95it/s, loss=0.7744]
Evaluating: 100%
 20/20 [00:02<00:00,  7.50it/s]

Train Loss: 0.7801
Eval Loss: 1.3503
nDCG@10: 0.0476
Recall@10: 0.0643

==================================================
Epoch 23/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.00it/s, loss=0.7386]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]

Train Loss: 0.7786
Eval Loss: 1.3369
nDCG@10: 0.0469
Recall@10: 0.0637

==================================================
Epoch 24/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.04it/s, loss=0.7202]
Evaluating: 100%
 20/20 [00:02<00:00,  7.58it/s]

Train Loss: 0.7760
Eval Loss: 1.3768
nDCG@10: 0.0473
Recall@10: 0.0632

==================================================
Epoch 25/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.97it/s, loss=0.8100]
Evaluating: 100%
 20/20 [00:02<00:00,  7.55it/s]

Train Loss: 0.7741
Eval Loss: 1.3837
nDCG@10: 0.0472
Recall@10: 0.0631

==================================================
Epoch 26/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.6979]
Evaluating: 100%
 20/20 [00:02<00:00,  7.59it/s]

Train Loss: 0.7696
Eval Loss: 1.4077
nDCG@10: 0.0470
Recall@10: 0.0632

==================================================
Epoch 27/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  6.99it/s, loss=0.8274]
Evaluating: 100%
 20/20 [00:02<00:00,  7.57it/s]

Train Loss: 0.7688
Eval Loss: 1.3934
nDCG@10: 0.0475
Recall@10: 0.0640

==================================================
Epoch 28/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.02it/s, loss=0.7066]
Evaluating: 100%
 20/20 [00:02<00:00,  7.54it/s]

Train Loss: 0.7681
Eval Loss: 1.3847
nDCG@10: 0.0471
Recall@10: 0.0635

==================================================
Epoch 29/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.01it/s, loss=0.8048]
Evaluating: 100%
 20/20 [00:02<00:00,  7.47it/s]

Train Loss: 0.7670
Eval Loss: 1.3943
nDCG@10: 0.0473
Recall@10: 0.0642

==================================================
Epoch 30/30
==================================================
Training: 100%
 292/292 [00:42<00:00,  7.03it/s, loss=0.6862]
Evaluating: 100%
 20/20 [00:02<00:00,  7.52it/s]

Train Loss: 0.7650
Eval Loss: 1.3963
nDCG@10: 0.0475
Recall@10: 0.0640